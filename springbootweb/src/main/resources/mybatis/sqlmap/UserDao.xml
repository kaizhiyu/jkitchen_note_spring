<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sauzny.springbootweb.dao.UserDao">

    <resultMap id="UserExt" type="com.sauzny.springbootweb.entity.dto.UserExt" extends="com.sauzny.springbootweb.dao.UserMapper.BaseResultMap">
        <collection property="roles" ofType="com.sauzny.springbootweb.entity.pojo.Role">
            <id column="role_id" jdbcType="INTEGER" property="id" />
            <result column="role_name" jdbcType="VARCHAR" property="name" />
        </collection>
    </resultMap>

    <select id="findUserInfo" parameterType="int" resultMap="UserExt">
        select tb_user.*,tb_role.id role_id,tb_role.name role_name
        from tb_user
        INNER JOIN tb_user_role_rel ON tb_user.id = tb_user_role_rel.user_id
        INNER JOIN tb_role ON tb_user_role_rel.role_id = tb_role.id
        WHERE tb_user.id = #{userId}
    </select>

    <insert id="batchInsert" parameterType="java.util.List">
        INSERT INTO
        tb_user
        (
        account,
        creater_id,
        password,
        phone,
        salt,
        username
        )
        VALUES
        <foreach collection="list" item="entity" separator=",">
            (
            #{entity.account},
            #{entity.createrId},
            #{entity.password},
            #{entity.phone},
            #{entity.salt},
            #{entity.username}
            )
        </foreach>
    </insert>
</mapper>
